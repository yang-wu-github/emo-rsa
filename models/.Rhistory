summarize(perc_correct = mean(check_score))
checks <- d %>%
filter(question == "check") %>%
mutate(response = case_when(response == "H" ~ "h")) %>%
# mutate(response = case_when(response == c("H", "h") ~ "H",
#                             response == c("L","l")  ~ "L",
#                             response == c("U","u")  ~ "U",
#                             response == c("O","o")  ~ "O",
#                             response == "Rectangle"  ~ "O",
#                             response == 0  ~ "O",
#                             response == "A square or rectangle"  ~ "O",
#                             response == "its more of a U"  ~ "U",
#                             response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0)) %>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
View(d)
View(checks)
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == c("H", "h") ~ "H",
response == c("L","l")  ~ "L",
response == c("U","u")  ~ "U",
response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U"))
View(checks)
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == c("L","l")  ~ "L",
response == c("U","u")  ~ "U",
response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U"))
View(checks)
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U"))
View(checks)
View(d)
View(filter(d, d$question == "check"))
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U"))
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0)) %>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
ggplot(checks, aes(perc_correct)) +
geom_histogram(binwidth=.01) +
theme_bw() +
xlab("accuracy on check questions") +
ylab("number of participants")
# Only include those who got 75% or more check questions correct
d <- full_join(d, checks) %>%
filter(perc_correct > .50) %>%
filter
# Only include those who got 75% or more check questions correct
d <- full_join(d, checks) %>%
filter(perc_correct = 1) %>%
filter
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0)) %>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
ggplot(checks, aes(perc_correct)) +
geom_histogram(binwidth=.01) +
theme_bw() +
xlab("accuracy on check questions") +
ylab("number of participants")
# Only include those who got 75% or more check questions correct
d <- full_join(d, checks) %>%
filter(perc_correct = 1) %>%
filter
head(d)
# Only include those who got 75% or more check questions correct
d <- full_join(d, checks) %>%
filter(perc_correct = 1) %>%
filter
# Only include those who got 75% or more check questions correct
d <- full_join(d, checks) %>%
filter(perc_correct == 1) %>%
filter
View(checks)
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0))
View(checks)
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0))
View(checks)
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0)) %>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
ggplot(checks, aes(perc_correct)) +
geom_histogram(binwidth=.01) +
theme_bw() +
xlab("accuracy on check questions") +
ylab("number of participants")
d <- d.raw %>%
slice(-1:-5) %>%
select(ResponseId, starts_with("PUtt_"), starts_with("NUtt_")) %>%
pivot_longer(cols = c(starts_with("PUtt_"), starts_with("NUtt_")),
names_to = "trial", values_to = "response") %>%
separate(trial, into=c("utt","exp","race", "gender","question", "random")) %>%
rename(id = `ResponseId`) %>%
mutate(question = case_when(question == "GT" ~ "true state",
question == "check" ~ "check"),
condition = case_when(utt == "PUtt" & exp == "PExp" ~ "PU_PE",
utt == "PUtt" & exp == "NExp" ~ "PU_NE",
utt == "NUtt" & exp == "PExp" ~ "NU_PE",
utt == "NUtt" & exp == "NExp" ~ "NU_NE"),
condition = fct_relevel(condition, "PU_PE", "PU_NE", "NU_PE", "NU_NE"),
response = fct_relevel(response, "1", "2", "3", "4", "5", "6")) %>%
select(-random) %>%
filter(response != "")
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0)) %>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
ggplot(checks, aes(perc_correct)) +
geom_histogram(binwidth=.01) +
theme_bw() +
xlab("accuracy on check questions") +
ylab("number of participants")
checks <- d %>%
filter(question == "check") %>%
#mutate(response = case_when(response == "H" ~ "h")) %>%
mutate(response = case_when(response == "H" ~ "H",
response == "h" ~ "H",
response == "L" ~ "L",
response == "l" ~ "L",
response == "O" ~ "O",
response == "o" ~ "O",
response == "U" ~ "U",
response == "u" ~ "U",
# response == c("L","l")  ~ "L",
# response == c("U","u")  ~ "U",
# response == c("O","o")  ~ "O",
response == "Rectangle"  ~ "O",
response == 0  ~ "O",
response == "A square or rectangle"  ~ "O",
response == "its more of a U"  ~ "U",
response == "A \"U\""  ~ "U")) %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0))
View(checks)
#d.raw <- read.csv(here("models/EMORSA2.csv"))
d.raw <- read.csv(here("models/201221EMO-RSA_MAIN_STATE_January 13, 2021_15.51.csv"))
d <- d.raw %>%
slice(-1:-5) %>%
select(ResponseId, starts_with("PUtt_"), starts_with("NUtt_")) %>%
pivot_longer(cols = c(starts_with("PUtt_"), starts_with("NUtt_")),
names_to = "trial", values_to = "response") %>%
separate(trial, into=c("utt","exp","race", "gender","question", "random")) %>%
rename(id = `ResponseId`) %>%
mutate(question = case_when(question == "GT" ~ "true state",
question == "check" ~ "check"),
condition = case_when(utt == "PUtt" & exp == "PExp" ~ "PU_PE",
utt == "PUtt" & exp == "NExp" ~ "PU_NE",
utt == "NUtt" & exp == "PExp" ~ "NU_PE",
utt == "NUtt" & exp == "NExp" ~ "NU_NE"),
condition = fct_relevel(condition, "PU_PE", "PU_NE", "NU_PE", "NU_NE"),
response = fct_relevel(response, "1", "2", "3", "4", "5", "6")) %>%
select(-random) %>%
filter(response != "")
checks <- d %>%
filter(question == "check") %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0))
%>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
checks <- d %>%
filter(question == "check") %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0)) %>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
ggplot(checks, aes(perc_correct)) +
geom_histogram(binwidth=.01) +
theme_bw() +
xlab("accuracy on check questions") +
ylab("number of participants")
View(checks)
# Only include those who got all check questions correct
d <- full_join(d, checks) %>%
filter(perc_correct == 1) %>%
filter
d2 <- d %>%
mutate(utt = case_when(utt == "PUtt" ~ "good",
utt == "NUtt" ~ "bad"),
exp = case_when(exp == "PExp" ~ "smile",
exp == "NExp" ~ "frown"),
utt = fct_relevel(utt, "good"),
exp = fct_relevel(exp, "smile"),
condition = case_when(condition=="PU_PE" ~ "good smile",
condition=="NU_NE" ~ "bad frown",
condition=="PU_NE" ~ "good frown",
condition=="NU_PE" ~ "bad smile"),
condition = factor(condition, levels=c("good smile", "bad frown", "good frown", "bad smile")))
# state: human
d.state <- d2[d$question=="true state",] %>%
group_by(condition, response) %>%
multi_boot_standard(col = "correct")
# state: human
d.state <- d2[d$question=="true state",] %>%
group_by(condition, response) %>%
count() %>%
mutate(probability = case_when(condition=="good smile" ~ n/59,
condition=="good frown" ~ n/58,
condition=="bad smile" ~ n/58,
condition=="bad frown" ~ n/58))
d2[d$question=="true state",]
head(d2)
# state: human
d.state <- d2[d2$question=="true state",] %>%
group_by(condition, response) %>%
count()
d.state
# state: human
d.state <- d2[d2$question=="true state",] %>%
group_by(condition) %>%
count()
d.state
#d.raw <- read.csv(here("models/EMORSA2.csv"))
d.raw <- read.csv(here("models/201221EMO-RSA_MAIN_STATE_January 13, 2021_15.51.csv"))
d <- d.raw %>%
slice(-1:-5) %>%
select(ResponseId, starts_with("PUtt_"), starts_with("NUtt_")) %>%
pivot_longer(cols = c(starts_with("PUtt_"), starts_with("NUtt_")),
names_to = "trial", values_to = "response") %>%
separate(trial, into=c("utt","exp","race", "gender","question", "random")) %>%
rename(id = `ResponseId`) %>%
mutate(question = case_when(question == "GT" ~ "true state",
question == "check" ~ "check"),
condition = case_when(utt == "PUtt" & exp == "PExp" ~ "PU_PE",
utt == "PUtt" & exp == "NExp" ~ "PU_NE",
utt == "NUtt" & exp == "PExp" ~ "NU_PE",
utt == "NUtt" & exp == "NExp" ~ "NU_NE"),
condition = fct_relevel(condition, "PU_PE", "PU_NE", "NU_PE", "NU_NE"),
response = fct_relevel(response, "1", "2", "3", "4", "5", "6")) %>%
select(-random) %>%
filter(response != "")
checks <- d %>%
filter(question == "check") %>%
mutate(check_score = case_when(race == "A" & grepl("H", response, ignore.case = TRUE) ~ 1,
race == "B" & grepl("O", response, ignore.case = TRUE) ~ 1,
race == "L" & grepl("U", response, ignore.case = TRUE) ~ 1,
race == "W" & grepl("L", response, ignore.case = TRUE) ~ 1,
TRUE ~ 0)) %>%
group_by(id) %>%
summarize(perc_correct = mean(check_score))
ggplot(checks, aes(perc_correct)) +
geom_histogram(binwidth=.01) +
theme_bw() +
xlab("accuracy on check questions") +
ylab("number of participants")
# Only include those who got all check questions correct
d <- full_join(d, checks) %>%
filter(perc_correct == 1) %>%
filter
d2 <- d %>%
mutate(utt = case_when(utt == "PUtt" ~ "good",
utt == "NUtt" ~ "bad"),
exp = case_when(exp == "PExp" ~ "smile",
exp == "NExp" ~ "frown"),
utt = fct_relevel(utt, "good"),
exp = fct_relevel(exp, "smile"),
condition = case_when(condition=="PU_PE" ~ "good smile",
condition=="NU_NE" ~ "bad frown",
condition=="PU_NE" ~ "good frown",
condition=="NU_PE" ~ "bad smile"),
condition = factor(condition, levels=c("good smile", "bad frown", "good frown", "bad smile")))
# state: human
d.state <- d2[d2$question=="true state",] %>%
group_by(condition) %>%
count()
d.state
# state: human
d.state <- d2[d2$question=="true state",] %>%
group_by(condition, response) %>%
count() %>%
mutate(probability = case_when(condition=="good smile" ~ n/55,
condition=="good frown" ~ n/55,
condition=="bad smile" ~ n/55,
condition=="bad frown" ~ n/55))
h.state.plot <- d.state %>%
ggplot(., aes(x = response, y = probability,
group = condition, color=condition))+
geom_line(position=pd) +
geom_point(position=pd) +
scale_color_brewer(palette="Dark2") +
ylim(0, 0.5) +
xlab("true state") +
ylab("proportion chosen") +
theme_bw() +
ggtitle("Human (pilot data)") +
theme(plot.title = element_text(hjust = 0.5))
pd <- position_dodge(0.2)
h.state.plot <- d.state %>%
ggplot(., aes(x = response, y = probability,
group = condition, color=condition))+
geom_line(position=pd) +
geom_point(position=pd) +
scale_color_brewer(palette="Dark2") +
ylim(0, 0.5) +
xlab("true state") +
ylab("proportion chosen") +
theme_bw() +
ggtitle("Human (pilot data)") +
theme(plot.title = element_text(hjust = 0.5))
h.state.plot
h.state.plot <- d.state %>%
ggplot(., aes(x = response, y = probability,
group = condition, color=condition))+
geom_line(position=pd) +
geom_point(position=pd) +
scale_color_brewer(palette="Dark2") +
ylim(0, 1) +
xlab("true state") +
ylab("proportion chosen") +
theme_bw() +
ggtitle("Human (pilot data)") +
theme(plot.title = element_text(hjust = 0.5))
h.state.plot
